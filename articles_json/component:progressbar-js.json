{"uid": 6057, "pageId": "component:progressbar-js", "title": "Progress bar component js code", "source": "\n[[code type=\"javascript\"]]\nfunction getBar(progress) {\n\u00a0\u00a0\u00a0\u00a0var bar = BAR_TEXT + ' [';\n\u00a0\u00a0\u00a0\u00a0var stage = Math.ceil(progress * STAGE_RATIO);\n\u00a0\u00a0\u00a0\u00a0for (var i = 1; i <= BAR_WIDTH; i++) {\n\u00a0\u00a0\u00a0\u00a0\tif (stage >= i) {\n\u00a0\u00a0\u00a0\u00a0\t\tbar += '=';\n\u00a0\u00a0\u00a0\u00a0\t} else {\n\u00a0\u00a0\u00a0\u00a0\t\tbar += '&nbsp;';\n\u00a0\u00a0\u00a0\u00a0\t}\n\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0bar += ']&nbsp;';\n\u00a0\u00a0\u00a0\u00a0if (progress === 100) {\n\u00a0\u00a0\u00a0\u00a0\tbar += COMPLETE_TEXT;\n\u00a0\u00a0\u00a0\u00a0} else {\n\u00a0\u00a0\u00a0\u00a0\tif (progress < 10) {\n\u00a0\u00a0\u00a0\u00a0\t\tbar += '&nbsp;'\n\u00a0\u00a0\u00a0\u00a0\t}\n\u00a0\u00a0\u00a0\u00a0\tbar += progress + '%';\n\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0return bar;\n}\n\ndocument.addEventListener('DOMContentLoaded', function () {\n\u00a0\u00a0\u00a0\u00a0var barElem = document.querySelector('.bar');\n\u00a0\u00a0\u00a0\u00a0var contentElem = document.querySelector('.content');\n\u00a0\u00a0\u00a0\u00a0var initButton = document.querySelector('.init-button');\n\u00a0\u00a0\u00a0\u00a0var loadingText = document.querySelector('.loading-text');\n\u00a0\u00a0\u00a0\u00a0initButton.innerHTML = BUTTON_TEXT;\n\n\u00a0\u00a0\u00a0\u00a0function onFinish() {\n\u00a0\u00a0\u00a0\u00a0\tcontentElem.style.display = 'block';\n\u00a0\u00a0\u00a0\u00a0\tif (HIDE_BAR_AFTER_FINISH) {\n\u00a0\u00a0\u00a0\u00a0\t\tbarElem.style.display = 'none';\n\u00a0\u00a0\u00a0\u00a0\t}\n\u00a0\u00a0\u00a0\u00a0}\n\u00a0\u00a0\u00a0\u00a0\n\u00a0\u00a0\u00a0\u00a0var initialTick = true;\n\n\u00a0\u00a0\u00a0\u00a0var onClickInit = function () {\n\u00a0\u00a0\u00a0\u00a0\tif (HIDE_BUTTON_AFTER_INIT) {\n\u00a0\u00a0\u00a0\u00a0\t\tinitButton.style.display = 'none';\n\u00a0\u00a0\u00a0\u00a0\t} else {\n\u00a0\u00a0\u00a0\u00a0\t\tinitButton.innerHTML = BUTTON_TEXT_AFTER_INIT;\n\u00a0\u00a0\u00a0\u00a0\t\tinitButton.removeEventListener('click', onClickInit);\n\u00a0\u00a0\u00a0\u00a0\t\tinitButton.style.color = '#000';\n\u00a0\u00a0\u00a0\u00a0\t}\n\n\u00a0\u00a0\u00a0\u00a0\tif (LOADING_TEXT) {\n\u00a0\u00a0\u00a0\u00a0\t\tloadingText.style.display = 'block';\n\u00a0\u00a0\u00a0\u00a0\t\tloadingText.innerHTML = LOADING_TEXT;\n\u00a0\u00a0\u00a0\u00a0\t}\n\n\u00a0\u00a0\u00a0\u00a0\tvar progress = 0;\n\u00a0\u00a0\u00a0\u00a0\t\n\u00a0\u00a0\u00a0\u00a0\tvar tick = function () {\n\u00a0\u00a0\u00a0\u00a0\t\tbarElem.innerHTML = getBar(progress);\n\u00a0\u00a0\u00a0\u00a0\t\tprogress += PROGRESS_STEP;\n\u00a0\u00a0\u00a0\u00a0\t\trequestAnimationFrame(function () {\n\u00a0\u00a0\u00a0\u00a0\t\t\tif (progress <= 100) {\n\u00a0\u00a0\u00a0\u00a0\t\t\t\tsetTimeout(tick, initialTick ? INITIAL_TICK_TIMEOUT\u00a0\u00a0: TICK_INTERVAL);\n\u00a0\u00a0\u00a0\u00a0\t\t\t\tinitialTick = false;\n\u00a0\u00a0\u00a0\u00a0\t\t\t} else {\n\u00a0\u00a0\u00a0\u00a0\t\t\t\tbarElem.innerHTML = getBar(100);\n\u00a0\u00a0\u00a0\u00a0\t\t\t\tonFinish();\n\u00a0\u00a0\u00a0\u00a0\t\t\t}\n\u00a0\u00a0\u00a0\u00a0\t\t});\n\u00a0\u00a0\u00a0\u00a0\t};\n\u00a0\u00a0\u00a0\u00a0\ttick();\n\u00a0\u00a0\u00a0\u00a0};\n\n\u00a0\u00a0\u00a0\u00a0initButton.addEventListener('click', onClickInit);\n});\n[[/code]]\n", "tags": ["\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0430:\u0432\u0438\u0437\u0443\u0430\u043b\u044c\u043d\u044b\u0439_\u044d\u043b\u0435\u043c\u0435\u043d\u0442"], "parent": null, "locked": false}